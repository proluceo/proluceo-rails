<%= form_with model: LedgerEntry.new, id: "form_ledger_entry" do |form| %>
  <div data-controller="ledger-entry-form">
    <% @parts.each_with_index do |part, index| %>
      <div class="ledger-entries-table ledger-entry-part min-w-full" id="ledger_entry_parts_<%= index %>">
        <%= form.fields_for "parts[#{index}]", part do |part_form| %>
          <%= part_form.date_field :position, class: "text-sm block shadow rounded-md border border-gray-200 outline-none px-3 py-2 w-full", data: { "ledger-entry-form-target" => "position", action: "ledger-entry-form#checkDate" } %>
          <%= part_form.collection_select :account_number, Account.companys, :number, :to_s, { prompt: "Select an account" }, { class: 'text-sm block shadow rounded-md border border-gray-200 outline-none px-3 py-2 w-full', data: { "ledger-entry-form-target" => "account", action: "ledger-entry-form#focusOnAmountField" } }  %>
          <%= part_form.number_field :debit_amount, step: 0.01, class: 'text-sm block shadow rounded-md border border-gray-200 outline-none px-3 py-2 w-full disabled:bg-slate-50 disabled:border-slate-200 disabled:shadow-none', data: { "ledger-entry-form-target" => "debit", action: "keydown.tab->ledger-entry-form#checkAmount keydown.enter->ledger-entry-form#checkAmount input->ledger-entry-form#checkTotalAmount" } %>
          <%= part_form.number_field :credit_amount, step: 0.01, class: 'text-sm block shadow rounded-md border border-gray-200 outline-none px-3 py-2 w-full disabled:bg-slate-50 disabled:border-slate-200 disabled:shadow-none', data: { "ledger-entry-form-target" => "credit", action: "keydown.tab->ledger-entry-form#checkAmount keydown.enter->ledger-entry-form#checkAmount input->ledger-entry-form#checkTotalAmount" } %>
          <div class="flex justify-end items-center">
            <%= form.submit "New line", class: "btn-white px-3 py-2 cursor-pointer" %>
          </div>
        <% end %>
      </div>
    <% end %>
    <div class="ledger-entries-table min-w-full">
      <%= form.submit "Create Ledger Entry", class: "btn-primary w-full", data: { "ledger-entry-form-target" => "formSubmit" } %>
    </div>
  </div>
<% end %>